<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Comparing two samples using stambo &mdash; stambo v0.1.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/msmb.css?v=51bd699f" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=0636b7af"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="_static/js/versions.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Comparing two regression models using stambo" href="Regression.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
          </a>
              <div class="version">
                0.1.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Welcome to stambo’s documentation!</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="stambo.html">Main functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Classification.html">Comparing two classification models using <code class="docutils literal notranslate"><span class="pre">stambo</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Classification_non_iid.html">Classification &amp; non-i.i.d. data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Regression.html">Comparing two regression models using <code class="docutils literal notranslate"><span class="pre">stambo</span></code></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Comparing two samples using <code class="docutils literal notranslate"><span class="pre">stambo</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Importing-the-libraries">Importing the libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Data-generation">Data generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Sample-comparison">Sample comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="#LaTeX-report">LaTeX report</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Grouped-data">Grouped data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Grouped-data-&amp;-paired-design">Grouped data &amp; paired design</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">stambo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Comparing two samples using <code class="docutils literal notranslate"><span class="pre">stambo</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Two_sample_test.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Comparing-two-samples-using-stambo">
<h1>Comparing two samples using <code class="docutils literal notranslate"><span class="pre">stambo</span></code><a class="headerlink" href="#Comparing-two-samples-using-stambo" title="Link to this heading"></a></h1>
<p><a class="reference external" href="https://mybinder.org/v2/gh/Oulu-IMEDS/stambo/main?labpath=notebooks%2FTwo_sample_test.ipynb"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a></p>
<p>V1.1.4: © Aleksei Tiulpin, PhD, 2025</p>
<p>There are many cases, when we develop models other than classification or regression, and we want to compute scores per datapoint, and then find their mean. We may often want to compare just two samples of measurements, and <code class="docutils literal notranslate"><span class="pre">stambo</span></code> allows to do this easily too.</p>
<p>This example shows how to conduct a simple two-sample test. The example is synthetic, and we will just simply generate two Gaussian samples, and assess whether the mean of the second sample is greater than the mean of the first sample.</p>
<section id="Importing-the-libraries">
<h2>Importing the libraries<a class="headerlink" href="#Importing-the-libraries" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">stambo</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">SEED</span><span class="o">=</span><span class="mi">2025</span>

<span class="n">stambo</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;0.1.4&#39;
</pre></div></div>
</div>
</section>
<section id="Data-generation">
<h2>Data generation<a class="headerlink" href="#Data-generation" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">sample_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
<span class="n">sample_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span><span class="o">+</span><span class="mf">0.7</span> <span class="c1"># effect size is 0.7</span>
</pre></div>
</div>
</div>
</section>
<section id="Sample-comparison">
<h2>Sample comparison<a class="headerlink" href="#Sample-comparison" title="Link to this heading"></a></h2>
<p>Note that when it comes to a two-sample test, <code class="docutils literal notranslate"><span class="pre">stambo</span></code> does not require the statistic of choice to be a machine learning metric that is a subclass of <code class="docutils literal notranslate"><span class="pre">stambo.metrics.Metric</span></code>. Note that we have a non-paired design here (a regular two-sample test), so, it needs to be specified.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">stambo</span><span class="o">.</span><span class="n">two_sample_test</span><span class="p">(</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">sample_2</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Mean&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()},</span> <span class="n">non_paired</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Bootstrapping: 100%|██████████| 10000/10000 [00:00&lt;00:00, 58539.44it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;Mean&#39;: array([ 0.18418158,  0.23771615, -0.12154188,  0.58512178,  0.08127468,
        -0.16881557,  0.33611198,  0.31899082,  0.0732373 ,  0.56617054])}
</pre></div></div>
</div>
</section>
<section id="LaTeX-report">
<h2>LaTeX report<a class="headerlink" href="#LaTeX-report" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">stambo</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">m1_name</span><span class="o">=</span><span class="s2">&quot;Control&quot;</span><span class="p">,</span> <span class="n">m2_name</span><span class="o">=</span><span class="s2">&quot;Treated&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
% \usepackage{booktabs} &lt;-- do not forget to have this imported.
\begin{tabular}{ll} \\
\toprule
\textbf{Model} &amp; \textbf{Mean} \\
\midrule
Control &amp; $0.08$ [$-0.17$-$0.34$] \\
Treated &amp; $0.32$ [$0.07$-$0.57$] \\
\midrule
Effect size &amp; $0.24$ [$-0.12$-$0.59]$ \\
\midrule
$p$-value &amp; $0.18$ \\
\bottomrule
\end{tabular}
</pre></div></div>
</div>
<p>This example shows that for the data at hand we did not have samples to reject the null.</p>
</section>
<section id="Grouped-data">
<h2>Grouped data<a class="headerlink" href="#Grouped-data" title="Link to this heading"></a></h2>
<p>A very common scenario we should consider is when data is grouped. For example, we have multiple datapoints from the same subjects.</p>
<p>Below is the simulation code that generates synthetic data for case when we have multiple datapoints from the same subject. To see if your data is grouped, you can plot a covaraince matrix of your data.</p>
<p>Here, we sample from a distribution of estimators of the covariance matrices to reveal the block structure. Here’s a breakdown of the sampling process: - <code class="docutils literal notranslate"><span class="pre">M</span></code>: Total number of subjects in the study. - <code class="docutils literal notranslate"><span class="pre">N</span></code>: Total number of measurements across all subjects. - <code class="docutils literal notranslate"><span class="pre">dim</span></code>: Dimensionality of each measurement (e.g., if measurements are scalar, dim=1). - <code class="docutils literal notranslate"><span class="pre">mean_range</span></code>: The range from which each subject’s mean measurement value is randomly sampled. - <code class="docutils literal notranslate"><span class="pre">base_cov</span></code>: A covariance matrix that defines how
measurements within the same subject may vary around the subject’s mean.</p>
<p>The process of data simulation involves: 1. Generating a specified number of measurements for each subject using a multinomial distribution, ensuring each subject has at least one measurement 2. Simulating the actual measurements for each subject based on their unique mean and a structured covariance matrix. This is repeated 1000 times to average out random fluctuations and get a stable estimate of the covariance structure across subjects.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example usage</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Number of subjects</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Total measurements</span>
<span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Dimensionality of each measurement</span>

<span class="n">mean_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Each subject&#39;s mean is sampled from this range</span>
<span class="n">base_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span>  <span class="c1"># Example structured covariance</span>

<span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">n_measurements_per_subj</span> <span class="o">=</span> <span class="n">stambo</span><span class="o">.</span><span class="n">synthetic</span><span class="o">.</span><span class="n">generate_n_measurements</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">d_temp</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># How many times to regenerate the dataset</span>
<span class="n">n_samples_cov</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples_cov</span><span class="p">):</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">subject_ids</span><span class="p">,</span> <span class="n">means</span> <span class="o">=</span> <span class="n">stambo</span><span class="o">.</span><span class="n">synthetic</span><span class="o">.</span><span class="n">generate_non_iid_measurements</span><span class="p">(</span><span class="n">n_measurements_per_subj</span><span class="p">,</span> <span class="n">mean_range</span><span class="p">,</span> <span class="n">base_cov</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="n">data</span> <span class="o">@</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span>

<span class="n">res</span> <span class="o">/=</span> <span class="n">n_samples_cov</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Subject-Level Covariance Structure&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">for</span> <span class="n">s_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
    <span class="n">n_per_i</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">subject_ids</span> <span class="o">==</span> <span class="n">s_id</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data for subject </span><span class="si">{</span><span class="n">s_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">n_per_i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Two_sample_test_13_0.png" src="_images/Two_sample_test_13_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Data for subject 0: 5
Data for subject 1: 11
Data for subject 2: 4
Data for subject 3: 17
Data for subject 4: 18
Data for subject 5: 14
Data for subject 6: 12
Data for subject 7: 11
Data for subject 8: 1
Data for subject 9: 7
</pre></div></div>
</div>
</section>
<section id="Grouped-data-&amp;-paired-design">
<h2>Grouped data &amp; paired design<a class="headerlink" href="#Grouped-data-&-paired-design" title="Link to this heading"></a></h2>
<p>Let us now cover another common case: we have a number of subjects with multiple measurements taken before and after treatment. We want to estimat the treatment effect. This case is highly related to comparing two models. Model 1 could be seen as control, and improvements done on it (Model 2) could be seen as treatment.</p>
<p>Here, we have developed functionality to generate data from a paired design. We can easily use stamo’s API to specify groups.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">paired_data</span><span class="p">,</span> <span class="n">s_ids_paired</span> <span class="o">=</span> <span class="n">stambo</span><span class="o">.</span><span class="n">synthetic</span><span class="o">.</span><span class="n">generate_paired_data</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_measurements</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">effect_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mean_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">paired_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Control&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">paired_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Treatment&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Two_sample_test_16_0.png" src="_images/Two_sample_test_16_0.png" />
</div>
</div>
<p>Let us now first run the test without specifying the groups.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">stambo</span><span class="o">.</span><span class="n">two_sample_test</span><span class="p">(</span><span class="n">paired_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">paired_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">statistics</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Mean&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()},</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stambo</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">m1_name</span><span class="o">=</span><span class="s2">&quot;Control&quot;</span><span class="p">,</span> <span class="n">m2_name</span><span class="o">=</span><span class="s2">&quot;Treatment&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Bootstrapping: 100%|██████████| 10000/10000 [00:00&lt;00:00, 50639.82it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
% \usepackage{booktabs} &lt;-- do not forget to have this imported.
\begin{tabular}{ll} \\
\toprule
\textbf{Model} &amp; \textbf{Mean} \\
\midrule
Control &amp; $0.36$ [$-0.10$-$0.83$] \\
Treatment &amp; $0.82$ [$0.46$-$1.21$] \\
\midrule
Effect size &amp; $0.46$ [$-0.07$-$1.00]$ \\
\midrule
$p$-value &amp; $0.09$ \\
\bottomrule
\end{tabular}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>What we can se above, is that the test does not detect an effect and the 95% on the effect size are very wide.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">stambo</span><span class="o">.</span><span class="n">two_sample_test</span><span class="p">(</span><span class="n">paired_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">paired_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">statistics</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Mean&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()},</span> <span class="n">groups</span><span class="o">=</span><span class="n">s_ids_paired</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="c1"># Let us add more digits to see the p-value clearer</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stambo</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">m1_name</span><span class="o">=</span><span class="s2">&quot;Control&quot;</span><span class="p">,</span> <span class="n">m2_name</span><span class="o">=</span><span class="s2">&quot;Treatment&quot;</span><span class="p">,</span> <span class="n">n_digits</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Bootstrapping: 100%|██████████| 10000/10000 [00:00&lt;00:00, 57055.19it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
% \usepackage{booktabs} &lt;-- do not forget to have this imported.
\begin{tabular}{ll} \\
\toprule
\textbf{Model} &amp; \textbf{Mean} \\
\midrule
Control &amp; $0.3640$ [$0.2471$-$0.5008$] \\
Treatment &amp; $0.8246$ [$0.7465$-$0.9272$] \\
\midrule
Effect size &amp; $0.4607$ [$0.3419$-$0.5721]$ \\
\midrule
$p$-value &amp; $0.0002$ \\
\bottomrule
\end{tabular}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>Once we have specified the groups, we get very tight 95% CIs around the true effect (0.5), showing that it is really positive. Moreover, we are able to reject the null, since our bootstrap procedure closely resembles the data generating process.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Regression.html" class="btn btn-neutral float-left" title="Comparing two regression models using stambo" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024-now, Aleksei Tiulpin.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    var versions_json_url = ''
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        v0.1.4
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>